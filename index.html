<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Simple</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="技术的终极目标是简洁">
<meta property="og:type" content="website">
<meta property="og:title" content="Simple">
<meta property="og:url" content="cedar-renjun.github.io/index.html">
<meta property="og:site_name" content="Simple">
<meta property="og:description" content="技术的终极目标是简洁">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Simple">
<meta name="twitter:description" content="技术的终极目标是简洁">
  
    <link rel="alternative" href="/atom.xml" title="Simple" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Do one thing and do it well</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/cedar-renjun" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/1995742315/profile?topnav=1&wvr=6" title="weibo">weibo</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/IAR/" style="font-size: 10px;">IAR</a> <a href="/tags/Jlink/" style="font-size: 10px;">Jlink</a> <a href="/tags/STM32F7/" style="font-size: 10px;">STM32F7</a> <a href="/tags/elua/" style="font-size: 10px;">elua</a> <a href="/tags/lua/" style="font-size: 10px;">lua</a> <a href="/tags/sublime-text/" style="font-size: 10px;">sublime text</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.miaoxiong.net/">喵兄</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://ahnniu.github.io/">牛工</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">Cedar, 嵌入式软件工程师，玩过各种MCU，熟悉无线协议栈，USB，RTOS，半个软件架构师，最近在折腾调试器. QQ: 819280802</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Do one thing and do it well</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="null" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">Do one thing and do it well</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/cedar-renjun" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/1995742315/profile?topnav=1&wvr=6" title="weibo">weibo</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-hello-elua" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/19/hello-elua/" class="article-date">
  	<time datetime="2015-10-18T16:36:27.000Z" itemprop="datePublished">2015-10-19</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/19/hello-elua/">Hello elua</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概述">概述</h3><p>下文会简单的介绍elua，然后编译固件，烧录到STM32F4 Nucleo板子上，最后用lua来编写一个简单的hello程序</p>
<h4 id="注意事项">注意事项</h4><p>在继续阅读之前，请看下面几点</p>
<ol>
<li>elua项目的版本比较多，代码文档和网站文档不一致，建议参考代码中的文档说明；本文档代码采用github master主分支0.9版本</li>
<li>本文以linux平台为例来说明编译过程，实际上，我是用树莓派来编译elua的，并用树莓派烧录，调试STM32；elua可以跨平台编译，具体请参考<a href="https://github.com/elua/elua/tree/master/doc/en">https://github.com/elua/elua/tree/master/doc/en</a>  building章节</li>
</ol>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/elua/">elua</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/lua/">lua</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2015/10/19/hello-elua/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-use-stm32F7-discovery-board" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/16/use-stm32F7-discovery-board/" class="article-date">
  	<time datetime="2015-10-16T15:04:31.000Z" itemprop="datePublished">2015-10-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/16/use-stm32F7-discovery-board/">STM32F7 Discovery 外部可用接口</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言">前言</h3><p>拿到板子后，我们重点需要考虑的是STM32F7的板子还有多少资源可供我们使用<br>这里重点关注的是通信接口（比如SPI／I2C／IO之类的），因为可以通过这些接口外挂器件，拓展功能<br>查看F7手册和Discovery板子原理图，可以知道Discovery采用的是216Pin管脚的F746NG芯片，虽然板子外设比较多，<br>但芯片IO足够用</p>
<p>板子功能框架如下所示</p>
<p><img src="http://cedar-renjun.github.io/images/2015/10/16/1.png" alt="Discovery功能框图"></p>
<p>大致将IO分为以下几个部分</p>
<ol>
<li>USB OTG(HS/FS)</li>
<li>Camera</li>
<li>Audio</li>
<li>Ethernet
      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/STM32F7/">STM32F7</a></li></ul>
	</div>

      

      
        <p class="article-more-link">
          <a  href="/2015/10/16/use-stm32F7-discovery-board/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-light-led-via-different-ways-in-rt-thread" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/15/light-led-via-different-ways-in-rt-thread/" class="article-date">
  	<time datetime="2015-10-15T15:27:20.000Z" itemprop="datePublished">2015-10-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/15/light-led-via-different-ways-in-rt-thread/">RT-Thread的小例子</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概述">概述</h3><p>嵌入式中最简单的就是按键，点亮LED，很多入门教程中，将这个作为例子来讲解<br>下面我就用这个最简单的例子，来演示RT-Thread线程通讯组件的不同使用方法</p>
<ul>
<li>关中断</li>
<li>关调度器</li>
<li>信号量</li>
<li>互斥量</li>
<li>事件</li>
<li>邮箱</li>
<li>消息队列</li>
</ul>
<p>关于按键检测，为了简单，我用了轮询的模式，100ms轮询一次，然后检测电平是否有变，并做判断；<br>当检测到按键按下时，就翻转LED电平</p>
<p>最后，我们尝试用消息队列来实现：按下键后，LED闪烁多次</p>
<h3 id="测试环境">测试环境</h3><ol>
<li>RT-Thread stable 2.0.0</li>
<li>STM32F446RE Nucleo板子</li>
<li>IAR For ARM 7.4</li>
</ol>
<h3 id="准备工作">准备工作</h3><ol>
<li>搭建IAR开发环境，调整启动代码和链接脚本</li>
<li>修改gpio.c里面的<code>static const struct pin_index pins[]</code>数组，因为我们的F446RE Nucleo板子按键和LED分别接到<br>PC13和PA5上面，所以需要在pins表示里面包含这两个管脚，我这里显示的27和54，如下所示</li>
</ol>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/RT-Thread/">RT-Thread</a>
	</div>


      
        <p class="article-more-link">
          <a  href="/2015/10/15/light-led-via-different-ways-in-rt-thread/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-use-rt-thread-finsh-cmd-tools" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/15/use-rt-thread-finsh-cmd-tools/" class="article-date">
  	<time datetime="2015-10-15T03:16:05.000Z" itemprop="datePublished">2015-10-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/15/use-rt-thread-finsh-cmd-tools/">使用RT-Thread Finsh</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="关于Finsh">关于Finsh</h3><p>了解一个东西，首先要知道组件的历史渊源，才能更好的理解它要解决的问题，这样就能更容易的理解它的架构和设计基础</p>
<p>官网对Finsh的介绍</p>
<pre><code>finsh是RT-<span class="keyword">Thread</span>的命令行外壳（shell），提供一套供用户在命令行的操作接口，主要用于调试、查看系统信息。 finsh支持两种模式：<span class="number">1.</span> <span class="keyword">C</span>语言解释器模式, 为行文方便称之为c-style；<span class="number">2.</span> 传统命令行模式，此模式又称为msh(module shell)。

<span class="keyword">C</span>语言表达式解释模式下, finsh能够解析执行大部分<span class="keyword">C</span>语言的表达式，并使用类似<span class="keyword">C</span>语言的函数调用方式访问系统中的函数及全局变量，此外它也能够通过命令行方式创建变量。

在msh模式下，finsh运行方式类似于dos/bash等传统shell。

在大部分嵌入式系统中，一般开发调试都使用硬件调试器和printf日志打印，在有些情况下，这两种方式并不是那么好用。比如对于RT-<span class="keyword">Thread</span>这个多线程系统，我们想知道某个时刻系统中的线程运行状态、手动控制系统状态。如果有一个shell，就可以输入命令，直接相应的函数执行获得需要的信息，或者控制程序的行为。这无疑会十分方便。

在嵌入式领域，<span class="keyword">C</span>语言是最常用的开发语言，如果shell程序的命令是<span class="keyword">C</span>语言的风格，那无疑是非常易用且有趣的。嵌入式设备通常采用交叉编译，一般需要将开发板与PC机连接起来通讯，常见连接方式包括，串口、USB、以太网、wifi等。一个灵活的shell应该可以在多种连接方式上工作。

finsh正是基于这些考虑而诞生的，finsh运行于开发板，它可以使用串口/以太网/USB等与PC机进行通信。下图是finsh的实际运行运行效果图。开发板运行RT-<span class="keyword">Thread</span>，并使能了finsh组件，通过串口与PC机连接，PC上运行Secure CRT。按下回车，然后输入list_thread()将会打印系统当前所有线程，以及状态。
</code></pre><p>传统的打印式手段，属于单向的；通过调试器来调试，不仅可以输出，而且可以输入，就属于双向的，但IDE的调试擅长于静态调试，比如设置断点，检查变量什么的；Finsh在一定程度上增强了动态调试功能，也使远程调试变得可能；RT－Thread为我们搭建了调试框架，用户不在需要单独编写解析命令机制，只需要关注需要导出的函数和变量;</p>
<p>Finsh里面动态线程的栈使用量，是一个很实用的功能<br>另，参考资料里面有个RT－Thread测试框架的介绍文章，可以构建自动化测试框架</p>
<h3 id="初步体验">初步体验</h3><p>这部分，RT－Thread官方的手册和跟我学RT－Thread写的很好，我就不自己敲字了，避免重复造轮子<br>请参考 <a href="http://www.rt-thread.org/download/manual/study_rtt.pdf" target="_blank" rel="external">http://www.rt-thread.org/download/manual/study_rtt.pdf</a> 第8篇和<a href="http://www.rt-thread.org/download/manual/rtthread_manual.zh.pdf" target="_blank" rel="external">http://www.rt-thread.org/download/manual/rtthread_manual.zh.pdf</a> 第11章</p>
<h3 id="移植">移植</h3><p>首先参考<a href="http://www.rt-thread.org/download/manual/study_rtt.pdf" target="_blank" rel="external">http://www.rt-thread.org/download/manual/study_rtt.pdf</a> 第8篇和<a href="http://www.rt-thread.org/download/manual/rtthread_manual.zh.pdf" target="_blank" rel="external">http://www.rt-thread.org/download/manual/rtthread_manual.zh.pdf</a> 第11章，在MDK环境下完成移植</p>
<p>如果您需要使用IAR工程，务必请阅读下一章的<code>IAR工程问题</code></p>
<h3 id="常见问题">常见问题</h3><h4 id="1-_IAR工程问题">1.    IAR工程问题</h4><p>RT-Thread scons脚本有一些bug，导致通过<code>scons --target=iar
-s</code>生成的脚本，没有包含启动代码和链接脚本，从而致使IAR工程工作不正常，具体表现为1）FINSH无法获取函数名，变量名<br>2）不能使用中断 3）系统初始化不正常</p>
<p>修复手段：</p>
<pre><code><span class="number">1.</span>    参考下面两个bug fix文件，修改BSP目录下对应的链接脚本和scons脚本
    <span class="number">1.</span>    https:<span class="comment">//github.com/RT-Thread/rt-thread/pull/566/files</span>
    <span class="number">2.</span>    https:<span class="comment">//github.com/RT-Thread/rt-thread/pull/565/files</span>
<span class="number">2.</span>    删掉旧工程，重新使用`scons --target=iar -s`生成IAR工程
<span class="number">3.</span>    手工在IAR工程中，添加link脚本(icf文件)
</code></pre><h4 id="2-_如何禁用HISTORY">2.    如何禁用HISTORY</h4><p>默认情况下，rtconfig.h没有出现FINSH_USING_HISTORY宏，RT-Thread启用HISTORY功能，并保持默认5条历史记录<br>可以通过在rtconfig.h中，显示定义<code>#define FINSH_USING_HISTORY 0</code>的方式来禁用HISTORY功能<br>通过定义<code>#define FINSH_HISTORY_LINES 5</code>来调整历史记录的长度</p>
<h3 id="原理分析">原理分析</h3><h4 id="0-_整体流程">0.    整体流程</h4><p>［占位符］以后添加</p>
<h4 id="1-_导出函数／变量">1.    导出函数／变量</h4><p>Finsh将需要导出的函数，添加信息后，封装到一个新的<code>finsh_sysvar</code>，<code>finsh_syscall</code> 结构体中，并将这个结构体放置在固定的段中<code>FSymTab</code>,  <code>VSymTab</code>，最后通过<code>__section_begin</code>／<code>__section_end</code>两个编译器函数来获取段的开始位置和结束位置<br>这些步骤等效于手工将导出结构体变量添加到一个预设的结构体数组中，如下所示</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> finsh_syscall _syscall_table[] =</span><br><span class="line">&#123;</span><br><span class="line">	&#123;<span class="string">"hello"</span>, hello&#125;,</span><br><span class="line">	&#123;<span class="string">"version"</span>, version&#125;,</span><br><span class="line">	&#123;<span class="string">"list"</span>, <span class="built_in">list</span>&#125;,</span><br><span class="line">	&#123;<span class="string">"list_thread"</span>, list_thread&#125;,</span><br><span class="line">	...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>但这么容易导致bug，因为注册表和函数实现的地方，往往不在同一个文件夹，过于分散，有时候，删除某个函数后，会忘记手工删除注册表的信息</p>
<p>RTT通过提供统一导出接口，将这个工作交给了编译器，最大程度的减少了bug的发生</p>
<p>岔开一个话题：对于某些静态驱动注册表来说，也可以利用这种方式实现。注意，仅仅是静态的，也就是说，段size在编译时就已经确定<br>RT－Thread的驱动架构没有这么做，而是提供驱动注册API，就是为了给静态驱动和动态驱动，提供统一的入口，更加方便灵活</p>
<h4 id="3-_编译和虚拟机执行">3.    编译和虚拟机执行</h4><p>这部分请参考阿莫论坛文章<a href="http://www.amobbs.com/thread-5539405-1-1.html" target="_blank" rel="external">http://www.amobbs.com/thread-5539405-1-1.html</a></p>
<h3 id="参考资料">参考资料</h3><ol>
<li><a href="http://www.rt-thread.org/download/manual/rtthread_manual.zh.pdf" target="_blank" rel="external">RT－Thread参考手册</a></li>
<li><a href="http://www.rt-thread.org/download/manual/study_rtt.pdf" target="_blank" rel="external">跟我一起学习RT－Thread</a></li>
<li><a href="http://www.rt-thread.org/page/29.html" target="_blank" rel="external">体验Finsh组件</a></li>
<li><a href="http://www.amobbs.com/thread-5539405-1-1.html" target="_blank" rel="external">Amobbs：Finsh原理分析</a></li>
<li><a href="http://blog.csdn.net/Prife/article/details/7487038" target="_blank" rel="external">RT-Thread测试框架的使用</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/RT-Thread/">RT-Thread</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-debug-cortex-m-hardfault" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/15/debug-cortex-m-hardfault/" class="article-date">
  	<time datetime="2015-10-15T03:15:43.000Z" itemprop="datePublished">2015-10-15</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/15/debug-cortex-m-hardfault/">debug cortex-m hardfault</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-raspberry-2B-feedback" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/13/raspberry-2B-feedback/" class="article-date">
  	<time datetime="2015-10-13T15:52:21.000Z" itemprop="datePublished">2015-10-13</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/13/raspberry-2B-feedback/">试用树莓派2B</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="1-_致谢">1. 致谢</h3><p>最近一直想学linux驱动编程和学习内核，刚好得到一块儿树莓派2B，所以准备用心搞一下<br>在此特意感谢21ic 小跑堂美女和may美女，刘sir</p>
<h3 id="2-_树莓派2B升级了什么">2. 树莓派2B升级了什么</h3><p>提到树莓派，大家都知道是什么东西，这里就不做背景介绍了，感兴趣的，可以参考树莓派官网介绍 <a href="https://www.raspberrypi.org/products/raspberry-pi-2-model-b/" target="_blank" rel="external">https://www.raspberrypi.org/products/raspberry-pi-2-model-b/</a></p>
<p>这次拿到的是2B板子，主要升级了内存和CPU<br>下面是官方网站展示的2B的性能参数：</p>
<ul>
<li>A 900MHz quad-core ARM Cortex-A7 CPU</li>
<li>1GB RAM</li>
<li>4 USB ports</li>
<li>40 GPIO pins</li>
<li>Full HDMI port</li>
<li>Ethernet port</li>
<li>Combined 3.5mm audio jack and composite video</li>
<li>Camera interface (CSI)</li>
<li>Display interface (DSI)</li>
<li>Micro SD card slot</li>
<li>VideoCore IV 3D graphics core</li>
</ul>
<p>相比于前代的树莓派，2B采用TF卡，尺寸更小，也去掉了不常用的RCA接口（俗称AV接口），完全采用HDMI接口<br>这么改，最大的好处就是树莓派形状变得很整齐，不再像原来那样突起一部分</p>
<p>从处理器来说，将原来的高通BCM2835更新到了BCM2836，增大RAM到1G，估计你对这些也不太感冒，只要知道速度提高了6倍就好了</p>
<p>6倍，6倍，6倍，重要的事情说三遍</p>
<p>因为处理器架构从ARM7TMDI变成了4核A7，所以能跑标准的操作系统，比如安卓或者ubuntu或者win10</p>
<p>大致看了win10烧录内核的步骤，看到“首先你需要一台运行win10的笔记本”，看到这里就没继续看了，哪位有兴趣的可以根据微软IOT团队官方博客来实战<br><a href="https://www.raspberrypi.org/blog/windows-10-for-iot/" target="_blank" rel="external">https://www.raspberrypi.org/blog/windows-10-for-iot/</a><br><a href="https://dev.windows.com/zh-cn/iot" target="_blank" rel="external">https://dev.windows.com/zh-cn/iot</a> </p>
<p>对了，树莓派2B支持DSI显示接口和CSI相机接口，从而可以直接高速视频输入和屏幕输出<br>这个有什么用呢？理论上来说，你可以拿树莓派做一个平板电脑</p>
<h3 id="无图无真相">无图无真相</h3><p>一个图片胜千言，show me the images now</p>
<p><img src="http://cedar-renjun.github.io/images/2015/10/13/0.png" alt="树莓派宣传图"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/1.jpg" alt="树莓派包装正面"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/2.jpg" alt="树莓派包装反面"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/3.jpg" alt="树莓派正面"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/4.jpg" alt="树莓派反面"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/5.jpg" alt="树莓派合照"><br><img src="http://cedar-renjun.github.io/images/2015/10/13/6.jpg" alt="树莓派大眼睛"></p>
<p>那个神秘的大眼睛是什么？？？<br>红外夜视摄像头，准备拿来做opencv人脸识别和视频监控，更多信息暂时保密</p>
<p>树莓派的简单介绍到这里，接下来介绍烧录系统，更新内核，跑opencv做人脸识别</p>
<h3 id="树莓派性能体验">树莓派性能体验</h3><p>试用了一个星期，最大的体验是树莓派性能有显著提高，6X绝对不是夸大<br>主要体现在</p>
<ol>
<li>编译opencv的时候，速度有很大提升</li>
<li>播放1080P的高清视频，硬解码，CPU占用率在2%左右，可以忽略不计</li>
</ol>
<p>前几代树莓派产品，据说跑视觉算法的时候，总是卡顿，树莓派2B在这方面有极大的提升，适合做视觉和图像处理相关的任务</p>
<p>如果您在做这方面的工作，可以尝试树莓派2B，也欢迎和我交流</p>
<h3 id="体验步骤">体验步骤</h3><p>我玩树莓派的步骤大致包括</p>
<ol>
<li>安装串口工具</li>
<li>连接树莓派串口，通过串口控制树莓派</li>
<li>连接无线网卡（360Wi-Fi），配置开机自动上网</li>
<li>通过SSH连接树莓派</li>
<li>如果你有屏幕和HDMI接口线，请连接树莓派；如果没有，则用realvnc在笔记本上显示远程桌面</li>
<li>编译源码，安装opencv</li>
<li>编写opencv测试程序</li>
<li>使用500W摄像头进行动作捕捉（进行中）</li>
</ol>
<p>这里仅仅做一个简要性的概述，列出注意事项，详细的命令和步骤，请参考blog文章或者网站上的文章</p>
<p>注意事项：</p>
<ol>
<li>树莓派2B的IO变为40Pin，但前26pin仍然兼容原来的树莓派，详细的GPIO列表，请参考<a href="http://www.element14.com/community/docs/DOC-73950/l/raspberry-pi-2-model-b-gpio-40-pin-block-pinout" target="_blank" rel="external">http://www.element14.com/community/docs/DOC-73950/l/raspberry-pi-2-model-b-gpio-40-pin-block-pinout</a></li>
<li>最近的树莓派内核（4.0以上），直接支持360Wi-Fi 2代（MT7601芯片），所以不需要进行重新编译内核和驱动；网上很多教程都是以3.x版本的内核为案例来讲述编译Wi-Fi网卡驱动和内核，请有取舍的参考</li>
<li>SSH连接，mac下可以直接用terminal，windows下可以用secure CRT</li>
<li>在编译opencv的时候，使用树莓派来wget或者git下载源码，可能会很慢；建议用PC机下载，然后通过scp命令来复制到树莓派主机上，实测Wi-Fi数据速率可以达到6M/S</li>
<li>编译opencv时，请参考opencv的官网3.0版本编译安装指南，网上教程很多是以opencv 2.4版本来介绍，因为新内核不在支持libtif4版本的库，所以会导致后面编译失败，，，切记，切记，我因为这个点，折腾了两天时间</li>
<li>安装VNC远程桌面时，请尽量使用realvnc server和viewer，网上很多人用tightvnc server，实际测试中，这个VNC会导致显示UI界面时，出现RANDER错误</li>
<li>在编译opencv时，会因为内存不够导致编译错误，显示4G内存完全用完，无法继续编译；解决方案就是重新调整linux扇区，来完全使用SD卡的8G内存，详情请参考<a href="http://cedar-renjun.github.io/2015/10/11/resize-raspberry-sd-volume/">http://cedar-renjun.github.io/2015/10/11/resize-raspberry-sd-volume/</a></li>
<li>播放1080P视频时，请使用omxplayer，这个播放器专门优化过，CPU占用率非常低，可以忽略不计，，，性能突出</li>
</ol>
<h3 id="最后">最后</h3><p>总体而言，树莓派2B的性能，有了显著的提升，可以跑各种操作系统，跑视觉和图像处理，值得购买</p>
<p>我正在通过树莓派学习opencv，欢迎交流</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/树莓派/">树莓派</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-install-opencv-on-raspberry2B" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/12/install-opencv-on-raspberry2B/" class="article-date">
  	<time datetime="2015-10-12T11:14:59.000Z" itemprop="datePublished">2015-10-12</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/12/install-opencv-on-raspberry2B/">安装opencv</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言">前言</h3><p>一直对opencv比较好奇，所以就尝试着在树莓派上面编译安装了opencv，参考了网上不少资料，各种折腾，最终搞定<br>最大的体会是要有耐心，装opencv折腾了2天多，下文主要记录安装步骤和注意事项</p>
<p>树莓派系统4.1.7</p>
<h3 id="开始折腾">开始折腾</h3><p>首先参考了这个 <a href="http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/" target="_blank" rel="external">http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/</a><br>文章，老外讲如何在树莓派上面利用opencv操纵CSI接口的摄像头，他用的是2.7版本的python和2.4版本的opencv，刚开始进行很顺利</p>
<p>到第二步的时候，找不到<code>libjpeg8-dev libtiff4-dev</code>这两个源，提示可以用<code>libjpeg-dev
libtiff5-dev</code>来替换，替换就替换吧，以为没事儿呢，结果到最后编译时，提示找不到<code>libtiff4-dev</code>的库文件，编译失败，，，，，</p>
<p>又卸载了各种安装包，参考官网教程安装了oepncv3.0和相关的库，这里就不贴步骤了，请参考<a href="http://docs.opencv.org/3.0-last-rst/doc/tutorials/introduction/linux_install/linux_install.html" target="_blank" rel="external">http://docs.opencv.org/3.0-last-rst/doc/tutorials/introduction/linux_install/linux_install.html</a></p>
<p>注意一点，在下面步骤之后<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> ~/&lt;my_working_directory&gt;</span><br><span class="line">git clone https://github.com/Itseez/opencv.git</span><br><span class="line">git clone https://github.com/Itseez/opencv_contrib.git</span><br></pre></td></tr></table></figure></p>
<p>下载的两个目录文件，要合并到同一个目录中，比如<code>source</code>目录，然后在source同级目录下建立<code>build</code>目录，然后按照官方的编译步骤，一步步来进行<br>这些步骤耗时比较长，可以通过PC用迅雷下载好，然后scp拷贝到树莓派中，进行编译<br>消耗的大致时间，请参考资料1中的耗时，还是比较准确的</p>
<p>编译完成后，install进行安装</p>
<p>然后通过编译读取图片的例子，参考C语言版本的 <a href="http://blog.csdn.net/moc062066/article/details/6312216" target="_blank" rel="external">http://blog.csdn.net/moc062066/article/details/6312216</a></p>
<p>编译完成后，记得terminal ssh<br>无法执行这个文件或者执行后看不到窗口，需要进入桌面环境来打开，如果你直接有一个显示器，那就可以直接运行，显示出来图片<br>没有的话，可以用VNC来远程显示桌面，不过记得要用realvnc的viewer和server，网上流行的tightvncserver会导致显示时出现RAND错误</p>
<p>当你按照步骤，执行完，opencv环境就搭建完毕</p>
<p>接下来，enjoy opencv</p>
<h3 id="参考资料">参考资料</h3><ol>
<li><a href="http://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/" target="_blank" rel="external">install-opencv-and-python-on-your-raspberry-pi-2-and-b</a></li>
<li><a href="http://opencv.org/" target="_blank" rel="external">opencv官网</a></li>
<li><a href="http://docs.opencv.org/3.0-last-rst/doc/tutorials/introduction/linux_install/linux_install.html" target="_blank" rel="external">官方编译指导</a></li>
<li><a href="http://docs.opencv.org/doc/tutorials/introduction/display_image/display_image.html" target="_blank" rel="external">Opencv例程显示图片</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/树莓派/">树莓派</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-resize-raspberry-sd-volume" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/11/resize-raspberry-sd-volume/" class="article-date">
  	<time datetime="2015-10-11T10:10:36.000Z" itemprop="datePublished">2015-10-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/11/resize-raspberry-sd-volume/">充分使用树莓派SD卡容量</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言">前言</h3><p>在编译opencv的时候，出现内存不够的情况，/root使用率100%，导致编译错误，所以需要拓展SD卡容量</p>
<p>google了一下，发现树莓派在默认情况下，仅仅使用了SD卡的4G容量，剩下的空间，属于空白分区，完全没有利用起来<br>所以，我们可以通过<code>df</code>命令，来调整linux分区的size</p>
<h3 id="操作步骤">操作步骤</h3><ol>
<li>重新树莓派，进入命令行页面</li>
<li>登陆树莓派，用户名<code>pi</code>，密码<code>raspberry</code></li>
<li><code>sudo su</code><br>切换至超级用户</li>
<li><code>df -h</code><br>显示出当前分区的状态和使用率</li>
<li>输入<code>fdisk /dev/mmcblk0</code> 加载SD卡</li>
<li><code>p</code>打印当前分区<br>你应该会看到三个分区(mmcblk0, mmcblk0p1, mmcblk0p2)，现在把分区2的信息写下来（/dev/mmcblk0p2）<br>我主要记录了开始扇区（122880）和结束扇区（8447999）的数值</li>
<li>按<code>d</code>开始删除分区</li>
<li>系统提示输入删除分区号，输入<code>2</code></li>
<li>按<code>n</code>新建分区，然后依次输入<code>p</code>, <code>2</code></li>
<li>接下来输入原来记录的2扇区开始号(122880)，记得替换成你自己的数字</li>
<li>按<code>w</code>保持配置</li>
<li>输入<code>reboot</code>重启树莓派</li>
<li>输入<code>sudo resize2fs /dev/mmcblk0p2</code> 更新系统</li>
<li>输入<code>df -h</code>看看，是不是已经完全使用了剩余空间</li>
</ol>
<h3 id="参考文档">参考文档</h3><ol>
<li><a href="http://ray.dotnetage.com/posts/2015-5-15/rpi-resize-sd/" target="_blank" rel="external">http://ray.dotnetage.com/posts/2015-5-15/rpi-resize-sd/</a></li>
<li><a href="http://m.blog.csdn.net/blog/lichao_ustc/46740443" target="_blank" rel="external">http://m.blog.csdn.net/blog/lichao_ustc/46740443</a></li>
<li><a href="http://www.rs-online.com/designspark/electronics/knowledge-item/raspberry-pi---%E8%B0%83%E6%95%B4%E4%BD%A0%E7%9A%84sd%E5%8D%A1%E5%88%86%E5%89%B2%E5%8C%BA%E7%9A%84%E5%A4%A7%E5%B0%8F" target="_blank" rel="external">http://www.rs-online.com/designspark/electronics/knowledge-item/raspberry-pi---%E8%B0%83%E6%95%B4%E4%BD%A0%E7%9A%84sd%E5%8D%A1%E5%88%86%E5%89%B2%E5%8C%BA%E7%9A%84%E5%A4%A7%E5%B0%8F</a></li>
<li><a href="http://www.computerhope.com/unix/udf.htm" target="_blank" rel="external">http://www.computerhope.com/unix/udf.htm</a></li>
<li><a href="http://www.cnblogs.com/peida/archive/2012/12/07/2806483.html" target="_blank" rel="external">http://www.cnblogs.com/peida/archive/2012/12/07/2806483.html</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/树莓派/">树莓派</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Build-Raspberry-Kernel" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/11/Build-Raspberry-Kernel/" class="article-date">
  	<time datetime="2015-10-10T16:27:06.000Z" itemprop="datePublished">2015-10-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/11/Build-Raspberry-Kernel/">编译树莓派内核</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言">前言</h3><p>拿到树莓派后，刚好手里有个360 Wi-Fi网卡（MT7601的芯片），就准备放树莓派上使用<br>插上去不识别，一搜才知道要重新编译内核，编译驱动什么的</p>
<p>原来没折腾过linux的编译，所以趁此机会，好好学习一下<br>期间查了网上很多资料，尝试，然后各种错误，最后还是<strong>官网资料英文资料最靠谱</strong></p>
<h3 id="搭建ubuntu环境">搭建ubuntu环境</h3><p>这个比较简单，请参考网上教程，完成ubuntu基本环境的搭建</p>
<h3 id="搭建交叉编译环境">搭建交叉编译环境</h3><p>编译内核，可以在树莓派上进行，也可以在PC主机上进行编译，因为PC主机内存大，CPU性能高，所以一般都是在PC上进行<br>这里就引入了一个名次“交叉编译环境”</p>
<p>其实，刚听说交叉编译时，以为是多么高大上的技术，后来发现，就是在PC上安装工具，为CPU编译出可执行文件<br>我们一直以来用MDK，IAR开发STM32，AVR，也算是交叉编译了，，，哈哈</p>
<p>这里不做过多解释</p>
<p>树莓派官方为我们提供了对应的编译工具</p>
<p>官方推荐用git来下载，命令如下<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone https://github.com/raspberrypi/tools</span><br></pre></td></tr></table></figure></p>
<p>但实际下载时，git的速度实在难以恭维，建议直接用浏览器去github页面点击”Down as zip”下载</p>
<p>特别注意：下载完成后，注意检查下载包是否完整，不然在编译时会出现一堆莫名其妙的错误</p>
<p>下载完成后，将tools解压到某一个目录(XXX)下，那么tools的可执行目录为</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">32</span>-bit 版本</span><br><span class="line">XXX/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin</span><br><span class="line"></span><br><span class="line"><span class="number">64</span>-bit 版本</span><br><span class="line">XXX/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian-x64/bin</span><br></pre></td></tr></table></figure>
<p>接下来，我们将这个路径添加到PATH环境变量中</p>
<p>这里有一个小插曲，因为我用的是普通用户，添加路径到.bashrc文件中后，编译源码的时候，提示没有系统权限，所以又加了sudo来提升权限<br>但是仍然编译出错，提示找不到gcc和ld工具，找了半天原因，发现<br>1）下载的tools压缩包不完整，丢失了一些文件，所以重新下载了tools<br>2）普通用户的.bashrc和超级用户的.bashrc不在同一个目录，即便是把PATH添加到/etc/profile中也不能，仍然会提示超级用户找不到gcc之类的错误<br>解决方法就是先通过<code>sudo su</code>来切换为超级用户，然后把PATH添加到root的.bashrc文件中</p>
<p>添加方法如下</p>
<ol>
<li>打开<code>root/.bashrc</code></li>
<li>在最后一行，添加<code>export PATH=$PATH:XXX/tools/arm-bcm2708/gcc-linaro-arm-linux-gnueabihf-raspbian/bin</code></li>
</ol>
<p>添加完成后，注销超级用户，然后重新切换为超级用户，在shell下输入<code>arm-linux-gnueabihf-gcc -v</code>来验证PATH变量是否生效</p>
<h3 id="下载内核源码">下载内核源码</h3><p>到git上下载源码<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git clone --depth=<span class="number">1</span> https://github.com/raspberrypi/linux</span><br></pre></td></tr></table></figure></p>
<p>还是那句话，git速度太慢，建议网页直接下载，但注意检查文件完整性<br>事后证明，很多错误，都是因为下载的源代码不完整导致的</p>
<p>下载后，随意放一个目录下，将目录名改为<code>linux</code></p>
<h3 id="编译内核">编译内核</h3><p>进入<code>linux</code>目录，输入下面的命令</p>
<p>树莓派1代<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ KERNEL=kernel</span><br><span class="line">$ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bcmrpi_defconfig</span><br><span class="line">$ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs</span><br></pre></td></tr></table></figure></p>
<p>树莓派2代<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ KERNEL=kernel7</span><br><span class="line">$ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- bcm2709_defconfig</span><br><span class="line">$ make ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs</span><br></pre></td></tr></table></figure></p>
<p>然后就是漫长的编译时间，在mac下，大概编译了一个小时左右<br>如果你电脑是多核的，可以在make 命令中增加<code>-jn</code>进行多线程编译<br>原则上，n是你处理器个数多1.5倍，比如我是4核电脑，就可以-j6</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ make -j6 ARCH=arm CROSS_COMPILE=arm-linux-gnueabihf- zImage modules dtbs</span><br></pre></td></tr></table></figure>
<p>编译完成后的安装过程，请参考<a href="https://www.raspberrypi.org/documentation/linux/kernel/building.md" target="_blank" rel="external">INSTALL DIRECTLY ONTO THE SD<br>CARD</a></p>
<p>最后，当我编译完成后，突然发现树莓派4.1.y内核已经默认支持了我的360wifi 2代，所以就没有继续编译网卡驱动了<br>^_^</p>
<h3 id="参考资料">参考资料</h3><ol>
<li><a href="https://www.raspberrypi.org/documentation/linux" target="_blank" rel="external">官方：树莓派Linux文档主页</a></li>
<li><a href="https://www.raspberrypi.org/documentation/linux/kernel/building.md" target="_blank" rel="external">官方：内核编译</a></li>
<li><a href="https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md" target="_blank" rel="external">官方：无线连接</a></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/树莓派/">树莓派</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Setup-STM32F7-develop-environment" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/08/Setup-STM32F7-develop-environment/" class="article-date">
  	<time datetime="2015-10-07T17:25:59.000Z" itemprop="datePublished">2015-10-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/08/Setup-STM32F7-develop-environment/">建立STM32 F7 MDK 开发环境</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="安装MDK5开发环境">安装MDK5开发环境</h3><ol>
<li>下载最新版<a href="http://www2.keil.com/mdk5/" target="_blank" rel="external">MDK5</a></li>
<li>利用<a href="http://cedar-renjun.github.io/assets/2015/10/8/Keil_ARM_MDK_5.00_Keygen_serial_Crack.exe.zip">工具</a> 破解MDK5</li>
</ol>
<p>以上两步比较简单，不详描述</p>
<h3 id="安装CubeF7">安装CubeF7</h3><p>CubeMX是ST提供的一套库和框架标准，也是一种工程模版</p>
<ol>
<li>下载<a href="http://www.st.com/web/en/catalog/tools/PF261909" target="_blank" rel="external">http://www.st.com/web/en/catalog/tools/PF261909</a></li>
<li>下载完成后，利用MDK5打开STM32Cube_FW_F7_V1.1.0\Projects\STM32746G-Discovery\Demonstration\MDK-ARM\Project.uvprojx</li>
</ol>
<h3 id="更新ST-Link驱动和固件">更新ST-Link驱动和固件</h3><ol>
<li>进入ST官网<a href="http://www.st.com/web/catalog/tools/FM146/CL1984/SC720/SS1450/PF251168?s_searchtype=partnumber" target="_blank" rel="external">http://www.st.com/web/catalog/tools/FM146/CL1984/SC720/SS1450/PF251168?s_searchtype=partnumber</a></li>
<li>通过<a href="http://www.st.com/web/en/catalog/tools/PF260219" target="_blank" rel="external">STSW-LINK009</a>更新st-link驱动</li>
<li>通过<a href="http://www.st.com/web/en/catalog/tools/PF258194" target="_blank" rel="external">STSW-LINK005</a>来更新固件</li>
</ol>
<h3 id="连接F7_Discovery开发板">连接F7 Discovery开发板</h3><ol>
<li>将<code>JP1</code>的跳帽安装到<code>5V-link</code></li>
<li>找一根mini USB线，插入<code>CN14</code></li>
<li>插入电脑USB口，这时系统会枚举出ST-link设备，然后F7会启动固件，在屏幕上显示图标</li>
</ol>
<h3 id="常见问题">常见问题</h3><h4 id="1_插入USB后，屏幕没亮；将USB插入充电器口，屏幕不亮">1 插入USB后，屏幕没亮；将USB插入充电器口，屏幕不亮</h4><p>因为默认通过ST-link来供电，插入电脑USB接口后，只有枚举成功后，才会开启MCU的供电系统<br>枚举的时候，100mA；枚举成功后，才能供电500mA，如果电脑USB不接受500mA或者使用USB，就会枚举失败<br>详细的信息，请参考<a href="http://www.st.com/st-web-ui/static/active/en/resource/technical/document/user_manual/DM00190424.pdf" target="_blank" rel="external">手册Power章节</a></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">STM32F746G-DISCO discovery board can be powered <span class="built_in">from</span> ST-LINK USB connector CN14 (<span class="number">5</span>V link), but only ST-LINK circuit has</span><br><span class="line"><span class="operator">the</span> power <span class="keyword">before</span> USB enumeration, because <span class="operator">the</span> host PC only provides <span class="number">100</span>mA <span class="built_in">to</span> <span class="operator">the</span> board <span class="keyword">at</span> that <span class="built_in">time</span>. During <span class="operator">the</span> USB</span><br><span class="line">enumeration, STM32F746G-DISCO board asks <span class="keyword">for</span> <span class="operator">the</span> <span class="number">500</span>mA power <span class="built_in">to</span> <span class="operator">the</span> host PC. If <span class="operator">the</span> host is able <span class="built_in">to</span> provide <span class="operator">the</span> required</span><br><span class="line">power, <span class="operator">the</span> enumeration finishes <span class="keyword">by</span> <span class="operator">a</span> “SetConfiguration” <span class="command"><span class="keyword">command</span> <span class="title">and</span> <span class="title">then</span>, <span class="title">the</span> <span class="title">power</span> <span class="title">transistor</span> <span class="title">U8</span> (<span class="title">ST890</span>) <span class="title">is</span> <span class="title">switched</span></span></span><br><span class="line">ON, <span class="operator">the</span> red LED LD2 is turned ON, thus STM32F746G-DISCO board can consume maximum <span class="number">500</span>mA current, but no more. If <span class="operator">the</span></span><br><span class="line">host is <span class="operator">not</span> able <span class="built_in">to</span> provide <span class="operator">the</span> requested current, <span class="operator">the</span> enumeration fails. Therefore <span class="operator">the</span> ST890 (U8) remains OFF <span class="operator">and</span> <span class="operator">the</span></span><br><span class="line">MCU part including <span class="operator">the</span> extension board won’t be powered. As <span class="operator">a</span> consequence <span class="operator">the</span> red LED LD2 remains turned OFF. In this</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">it</span> is mandatory <span class="built_in">to</span> use <span class="operator">an</span> external power supply.</span><br></pre></td></tr></table></figure>
<h4 id="2_用MDK5编译工程后，下载到板子，图标显示不正常">2 用MDK5编译工程后，下载到板子，图标显示不正常</h4><p>MDK的download工具，默认没有支持外部Flash的算法，所以会导致没有图标的部分，没有烧录到FLASH芯片</p>
<p>解决方案</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- Open STM32 ST-Link Utility V3.<span class="number">6</span>, click on "External Loader" from the bar menu then check "N25Q128A_STM32F746G-DISCO" box </span><br><span class="line">- Connect the STM32746G-DISCOVERY board to PC with USB cable through CN14</span><br><span class="line">- Use "STM32CubeDemo_STM32746G-DISCO_V1.<span class="number">0</span>.<span class="number">1</span>.hex" file with STM32 ST-Link Utility to program both internal Flash and external QSPI memory</span><br><span class="line">- Run the demonstration</span><br></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/STM32F7/">STM32F7</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Networking-and-the-BSD-Sockets-APIs" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/07/Networking-and-the-BSD-Sockets-APIs/" class="article-date">
  	<time datetime="2015-10-07T03:56:59.000Z" itemprop="datePublished">2015-10-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/07/Networking-and-the-BSD-Sockets-APIs/">Networking and the BSD Sockets APIs</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>by Michael Beam<br>12/27/2002</p>
<p>原文链接: <a href="http://www.macdevcenter.com/pub/a/mac/2002/12/26/cocoa.html?page=1">http://www.macdevcenter.com/pub/a/mac/2002/12/26/cocoa.html?page=1</a></p>
<p>We’ve spend a great deal of time talking about Rendezvous in the previous two columns, but Rendezvous can’t exist in a vacuum. Having user-friendly service discovery does us no good unless we can make our applications talk to one another. Indeed, Rendezvous has absolutely no provisions for facilitating general network communications between applications, as it is only a protocol for advertising and discovering services on a network. It is a discovery protocol, not a communications protocol.</p>
<p>Today we shift gears into the communications side of this business; we will have very little to say about Rendezvous. Due to its Unix lineage, Mac OS X is a wonderful platform for learning about networking, since it has such a rich set of APIs to offer; in particular, we can program with the venerable BSD sockets API. Today we’ll learn about this API, and in doing so we will write a tiny pair of C applications that demonstrate how clients and servers can be made to talk with one another. In the next column, we will finish RCE with what we learn today by adding some Cocoa.</p>
<h4 id="Concerning_Sockets">Concerning Sockets</h4><p>Most of us have likely heard of sockets in the course of our experiences programming. I had always heard about sockets, but up until about half a year ago, I had never had the pleasure of programming with them. Having heard of something is far from understanding it, which is essential to being able to effectively use a technology. In this column and the next, I hope to spark some interest in the subject to give you a feel for the technology. Hopefully, many of you who had previously shied away from sockets and networking will go on to learn more about this interesting and relevant topic.</p>
<p>So just what is a socket? The man page for the socket() function, which we use to create sockets, describes this little thing in four words: an endpoint for communication. The analogy often used to relate sockets to everyday experiences is that of a telephone, which, as we will see, is indeed an accurate comparison. A telephone is, after all, an endpoint, or an interface, to a communications network that we use to communicate with other people.</p>
<p>In the same way that we speak into and listen to a phone, applications both send data across a network by writing to a socket, and receive data sent by a remote host by reading from the socket. If you are familiar with the Unix APIs for reading and writing to a file, you will be comfortable with sockets, as the same functions for file I/O are used for socket I/O – namely, read() and write().</p>
<p>Like two telephones that facilitate a conversation between two people, network connections exist between a pair of sockets, one for each end of the connection. Sockets are often talked about in pairs: one for the server side of the application, and one for the client side. The networking model that we are accustomed to is that of the relationship between a client and a server. A server is an application that is listening for connection requests from clients, and handling them appropriately. A client is a program that connects to a server. Usually client and servers are two completely different applications, as is the case with a Web client and server: Apache is a Web server, while OmniWeb, Internet Explorer, and Mozilla are all Web clients.</p>
<p>We will see in the next column how this distinction between server and client blurs when we talk about peer-to-peer chat applications like RCE. Sometimes, one application is both a client and a server that allows connections from other like applications. This is especially true of peer-to-peer applications, such as the chat application we’re building. We’ll get into this more in the next column, but understand as we progress through our discussion today that RCE will have both server functionality and client functionality.</p>
<h4 id="Working_With_Sockets">Working With Sockets</h4><p>Because of the differing tasks of a server and a client, their use of sockets is accordingly different. The role each side takes in establishing a communications link is reflected in the nature of the sockets each side uses. To wit, servers use what are known as passive sockets, and clients use active sockets.</p>
<p>When a server process starts up, it must create a socket; bind it to a local, unused port; tell that socket to listen for new connections from clients; and finally, begin waiting for new connections. This socket is often referred to as a listening socket, or a passive socket, or a server socket. All of these names suggest that the role of the socket is to sit patiently while listening to its assigned port for clients requesting a connection with the server. In the analogy of the telephone, creating the socket is like buying a phone, binding is akin to getting a hookup from the phone company, listening is plugging your phone into the wall, and finally, accepting is the act of answering the phone when it rings.</p>
<p>When a connection is received by the listening socket, the server must accept the connection and return a new connected socket that is used to communicate with the client. This new socket has an established connection to the client’s remote socket. By creating a new socket to handle the new connection, the listening socket is free to continue doing its thing, listening for connections from other clients.</p>
<p>Clients use sockets in a different way. A client creates a socket in the same way as a server; however, after the socket is created the use of the socket differs. With a socket in hand, the client uses that socket to attempt to connect to a server. Once the connection has been accepted by the server, the client can begin sending and receiving data from the server. Referring back to our phone analogy, connecting is no different than dialing a phone number for someone you want to talk to.</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/socket/">socket</a>
	</div>


      
        <p class="article-more-link">
          <a  href="/2015/10/07/Networking-and-the-BSD-Sockets-APIs/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Port-to-gcc" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/06/Port-to-gcc/" class="article-date">
  	<time datetime="2015-10-06T03:39:47.000Z" itemprop="datePublished">2015-10-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/06/Port-to-gcc/">ARM GCC移植指导</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概述">概述</h3><p>本文主要介绍MDK代码移植到ARM GCC中的注意事项，以及对应的编译器指令</p>
<p>主要包括</p>
<ul>
<li>启动文件</li>
<li>链接脚本</li>
<li>汇编文件</li>
<li>编译器指令</li>
<li>其它</li>
</ul>
<h3 id="启动文件">启动文件</h3><p>选择适用于gcc as汇编器的启动文件，并注意添加bss的清零和data的复制代码，用于初始化C<br>runtime，如果使用到了C++，还需要手工复制构造函数表和全局变量表，并调用_start函数来初始化C lib</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/gcc/">gcc</a>
	</div>


      
        <p class="article-more-link">
          <a  href="/2015/10/06/Port-to-gcc/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Set-Up-scons-environment" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/06/Set-Up-scons-environment/" class="article-date">
  	<time datetime="2015-10-06T01:49:41.000Z" itemprop="datePublished">2015-10-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/06/Set-Up-scons-environment/">建立scons开发环境</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="概述">概述</h3><p>本文重点介绍win7环境下安装arm gcc编译器和scons编译系统的过程</p>
<p>注意：对于arm gcc和scons的介绍信息，请参考本博客《arm gcc简介》，《scons系统简介》</p>
<h3 id="安装步骤">安装步骤</h3><h4 id="1-_安装gcc">1. 安装gcc</h4><p>这里采用launchapad的arm-none-eabi-gcc，官网<a href="https://launchpad.net/gcc-arm-embedded/" target="_blank" rel="external">https://launchpad.net/gcc-arm-embedded/</a><br>进入<a href="https://launchpad.net/gcc-arm-embedded/+download" target="_blank" rel="external">下载页面</a>， 根据自己的系统，选择对应的版本，我这里下载32位最新版4.9<a href="https://launchpad.net/gcc-arm-embedded/4.9/4.9-2015-q3-update/+download/gcc-arm-none-eabi-4_9-2015q3-20150921-win32.exe" target="_blank" rel="external">gcc-arm-none-eabi-4_9-2015q3-20150921-win32.exe</a></p>
<p>点击安装，一路next，保持默认安装路径，安装完成界面，会有4个复选框，勾选</p>
<ul>
<li><code>Add path to environment variable</code></li>
<li><code>Add registry information</code><br>点击完成，arm gcc安装完成</li>
</ul>
<h4 id="2-_安装python_2-xx">2. 安装python 2.xx</h4><p><strong>注意:</strong> 一定要安装2.xx版本的python<br>进入python下载页面<a href="https://www.python.org/downloads/release/python-2710/，" target="_blank" rel="external">https://www.python.org/downloads/release/python-2710/，</a> 选择对应系统的python<br>这里选择32位2.7自安装包版本<br><a href="https://www.python.org/ftp/python/2.7.10/python-2.7.10.msi" target="_blank" rel="external">https://www.python.org/ftp/python/2.7.10/python-2.7.10.msi</a></p>
<p>点击安装，一路next，保持默认安装路径和配置选项，直到安装完成</p>
<h4 id="3-_安装scons">3. 安装scons</h4><p>进入scons下载页面<a href="http://www.scons.org/download.php" target="_blank" rel="external">http://www.scons.org/download.php</a><br>下载2.4版本的windows安装包<a href="http://prdownloads.sourceforge.net/scons/scons-2.4.0-setup.exe" target="_blank" rel="external">http://prdownloads.sourceforge.net/scons/scons-2.4.0-setup.exe</a></p>
<p>点击安装，一路next，保持默认安装路径和配置选项，直到安装完成</p>
<h4 id="4-_更新环境变量">4. 更新环境变量</h4><p>打开系统环境变量配置页<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">开始－》计算机－》属性－》高级系统设置－》环境变量－》系统变量－》<span class="built_in">Path</span>－》编辑</span><br></pre></td></tr></table></figure></p>
<p>检查Path是否有下面三项，没有则添加<br><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">C:\<span class="title">Python27</span>;<span class="title">C</span>:\<span class="title">Python27</span>\<span class="title">Scripts</span>;<span class="title">C</span>:\<span class="title">Program</span> <span class="title">Files</span>\<span class="title">GNU</span> <span class="title">Tools</span> <span class="title">ARM</span> <span class="title">Embedded</span>\4.9 2015<span class="title">q3</span>\<span class="title">bin</span></span></span><br></pre></td></tr></table></figure></p>
<p><strong>注意</strong>: Path 用<code>;</code>来分割路径</p>
<h4 id="5-_测试系统">5. 测试系统</h4><p>打开Cmd窗口，输入<code>arm-none-eabi-gcc -v</code>, <code>python -V</code>, <code>scons -v</code><br><strong>注意</strong>: <code>python -V</code>中的V要大写</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">PS C:\Users&gt; arm-none-eabi-gcc -v</span><br><span class="line">Using built-<span class="flow">in</span> specs.</span><br><span class="line">COLLECT_GCC=C:\Program Files\GNU Tools ARM Embedded\<span class="number">4</span>.<span class="number">9</span> <span class="number">2015</span>q3\bin\arm-none-eabi-gcc.exe</span><br><span class="line">COLLECT_LTO_WRAPPER=c:/program\ files/gnu\ tools\ arm\ embedded/<span class="number">4</span>.<span class="number">9</span>\ <span class="number">2015</span>q3/bin/../lib/gcc/arm-none-eabi/<span class="number">4</span>.<span class="number">9</span>.<span class="number">3</span>/lto-wrapp</span><br><span class="line">er.exe</span><br><span class="line"><span class="function">Target: <span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span></span><br><span class="line"><span class="title">Configured</span> <span class="title">with</span>: /<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">src</span>/<span class="title">gcc</span>/<span class="title">configure</span> --<span class="title">build</span>=<span class="title">i686</span>-<span class="title">linux</span>-<span class="title">gnu</span> --<span class="title">host</span>=<span class="title">i686</span>-<span class="title">w64</span>-<span class="title">mingw32</span> --<span class="title">targe</span></span><br><span class="line"><span class="title">t</span>=<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span> --<span class="title">prefix</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span> --<span class="title">libexecdir</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">instal</span></span><br><span class="line"><span class="title">l</span>-<span class="title">mingw</span>/<span class="title">lib</span> --<span class="title">infodir</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span>/<span class="title">share</span>/<span class="title">doc</span>/<span class="title">gcc</span>-<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span>/<span class="title">info</span> --<span class="title">mandir</span>=/<span class="title">home</span>/<span class="title">build</span></span><br><span class="line">/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span>/<span class="title">share</span>/<span class="title">doc</span>/<span class="title">gcc</span>-<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span>/<span class="title">man</span> --<span class="title">htmldir</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span></span><br><span class="line">/<span class="title">share</span>/<span class="title">doc</span>/<span class="title">gcc</span>-<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span>/<span class="title">html</span> --<span class="title">pdfdir</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span>/<span class="title">share</span>/<span class="title">doc</span>/<span class="title">gcc</span>-<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span>/<span class="title">pdf</span></span><br><span class="line">--<span class="title">enable</span>-<span class="title">languages</span>=<span class="title">c</span>,<span class="title">c</span>++ --<span class="title">disable</span>-<span class="title">decimal</span>-<span class="title">float</span> --<span class="title">disable</span>-<span class="title">libffi</span> --<span class="title">disable</span>-<span class="title">libgomp</span> --<span class="title">disable</span>-<span class="title">libmudflap</span> --<span class="title">disable</span>-<span class="title">libqu</span></span><br><span class="line"><span class="title">admath</span> --<span class="title">disable</span>-<span class="title">libssp</span> --<span class="title">disable</span>-<span class="title">libstdcxx</span>-<span class="title">pch</span> --<span class="title">disable</span>-<span class="title">nls</span> --<span class="title">disable</span>-<span class="title">shared</span> --<span class="title">disable</span>-<span class="title">threads</span> --<span class="title">disable</span>-<span class="title">tls</span> --<span class="title">with</span>-<span class="title">gn</span></span><br><span class="line"><span class="title">u</span>-<span class="title">as</span> --<span class="title">with</span>-<span class="title">gnu</span>-<span class="title">ld</span> --<span class="title">with</span>-<span class="title">headers</span>=<span class="title">yes</span> --<span class="title">with</span>-<span class="title">newlib</span> --<span class="title">with</span>-<span class="title">python</span>-<span class="title">dir</span>=<span class="title">share</span>/<span class="title">gcc</span>-<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span> --<span class="title">with</span>-<span class="title">sysroot</span>=/<span class="title">home</span>/<span class="title">build</span></span><br><span class="line">/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">install</span>-<span class="title">mingw</span>/<span class="title">arm</span>-<span class="title">none</span>-<span class="title">eabi</span> --<span class="title">with</span>-<span class="title">libiconv</span>-<span class="title">prefix</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">l</span></span><br><span class="line"><span class="title">ibs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">gmp</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">mpfr</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">b</span></span><br><span class="line"><span class="title">uild</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">mpc</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">isl</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span></span><br><span class="line">/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">cloog</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">li</span></span><br><span class="line"><span class="title">belf</span>=/<span class="title">home</span>/<span class="title">build</span>/<span class="title">work</span>/<span class="title">GCC</span>-4-9-<span class="title">build</span>/<span class="title">build</span>-<span class="title">mingw</span>/<span class="title">host</span>-<span class="title">libs</span>/<span class="title">usr</span> --<span class="title">with</span>-<span class="title">host</span>-<span class="title">libstdcxx</span>='-<span class="title">static</span>-<span class="title">libgcc</span> -<span class="title">Wl</span>,-<span class="title">Bstatic</span>,-<span class="title">lstdc</span>+</span><br><span class="line">+,-<span class="title">Bdynamic</span> -<span class="title">lm</span>' --<span class="title">with</span>-<span class="title">pkgversion</span>='<span class="title">GNU</span> <span class="title">Tools</span> <span class="title">for</span> <span class="title">ARM</span> <span class="title">Embedded</span> <span class="title">Processors</span>' --<span class="title">with</span>-<span class="title">multilib</span>-<span class="title">list</span>=<span class="title">armv6</span>-<span class="title">m</span>,<span class="title">armv7</span>-<span class="title">m</span>,<span class="title">armv7e</span>-<span class="title">m</span></span><br><span class="line">,<span class="title">cortex</span>-<span class="title">m7</span>,<span class="title">armv7</span>-<span class="title">r</span></span><br><span class="line"><span class="title">Thread</span> <span class="title">model</span>: <span class="title">single</span></span><br><span class="line"><span class="title">gcc</span> <span class="title">version</span> 4.9.3 20150529 (<span class="title">release</span>) [<span class="title">ARM</span>/<span class="title">embedded</span>-4<span class="title">_9</span>-<span class="title">branch</span> <span class="title">revision</span> 227977] (<span class="title">GNU</span> <span class="title">Tools</span> <span class="title">for</span> <span class="title">ARM</span> <span class="title">Embedded</span> <span class="title">Processors</span>)</span><br><span class="line"><span class="title">PS</span> <span class="title">C</span>:\<span class="title">Users</span>&gt; <span class="title">python</span> -<span class="title">V</span></span><br><span class="line"><span class="title">Python</span> 2.7.10</span><br><span class="line"><span class="title">PS</span> <span class="title">C</span>:\<span class="title">Users</span>&gt; <span class="title">scons</span> -<span class="title">v</span></span><br><span class="line"><span class="title">SCons</span> <span class="title">by</span> <span class="title">Steven</span> <span class="title">Knight</span> <span class="title">et</span> <span class="title">al</span>.:</span><br><span class="line">        <span class="title">script</span>: <span class="title">v2</span>.4.0.<span class="title">rel_2</span>.4.0:3365:9259<span class="title">ea1c13d7</span>, 2015/09/21 14:03:43, <span class="title">by</span> <span class="title">bdbaddog</span> <span class="title">on</span> <span class="title">hpmicrodog</span></span><br><span class="line">        <span class="title">engine</span>: <span class="title">v2</span>.4.0.<span class="title">rel_2</span>.4.0:3365:9259<span class="title">ea1c13d7</span>, 2015/09/21 14:03:43, <span class="title">by</span> <span class="title">bdbaddog</span> <span class="title">on</span> <span class="title">hpmicrodog</span></span><br><span class="line">        <span class="title">engine</span> <span class="title">path</span>: ['<span class="title">C</span>:\\<span class="title">Python27</span>\\<span class="title">scons</span>-2.4.0\\<span class="title">SCons</span>']</span><br><span class="line"><span class="title">Copyright</span> (<span class="title">c</span>) 2001 - 2015 <span class="title">The</span> <span class="title">SCons</span> <span class="title">Foundation</span></span><br><span class="line"><span class="title">PS</span> <span class="title">C</span>:\<span class="title">Users</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>至此，所有的系统配置已经完成</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/scons/">scons</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Use-gdb-debug-cortex-m-mcu-via-jlink-gdb-server" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/04/Use-gdb-debug-cortex-m-mcu-via-jlink-gdb-server/" class="article-date">
  	<time datetime="2015-10-04T12:17:54.000Z" itemprop="datePublished">2015-10-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/04/Use-gdb-debug-cortex-m-mcu-via-jlink-gdb-server/">用gdb调试Cortex-M系列芯片</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="准备工作">准备工作</h3><p>本文假设读者</p>
<ol>
<li>已经熟悉arm gcc工具链</li>
<li>已经在win中安装好mingw或者arm-none-eabi-gcc工具</li>
<li>具有合适的代码工程和编译脚本，且编译输出elf文件时，已添加<code>-g</code>选项来生成调试信息</li>
<li>安装jlink调试工具和对应驱动</li>
<li>有对应的硬件电路</li>
</ol>
<p>如果其中任何一项不满足，请自行google相关文档，完成基础准备工作</p>
<h3 id="启动jlink_gdb_server">启动jlink gdb server</h3><ol>
<li>开始 -&gt; SEGGER -&gt; Jlink V4.90e -&gt; Jlink GDB Server</li>
<li>Jlink会显示GDB config配置选项，如下图配置<br><img src="http://cedar-renjun.github.io/images/2015/10/4/1.png" alt="GDB Server配置选项"></li>
<li>点击OK，启动GDB server，在J-Link一栏会显示<code>Connected</code>字符，表示成功连接硬件，如下图所示<br><img src="http://cedar-renjun.github.io/images/2015/10/4/2.png" alt="GDB Server配置完成"></li>
</ol>
<h3 id="启动GDB">启动GDB</h3><ol>
<li>打开CMD，输入<code>arm-none-eabi-gdb</code>，打开后，如下图所示；如果没有显示对应信息，属于没有配置环境变量的path，请添加gcc<br>tools的路径进去</li>
<li>输入<code>file Demo.elf</code>加载调试文件，这里以<code>Demo.elf</code>为例，实际你可以替换为自己的elf文件</li>
<li>输入<code>target remote localhost:2331</code>，连接gdb server，连接成功后，会在Jlink GDB server中显示对应的状态，如下所示<br><img src="http://cedar-renjun.github.io/images/2015/10/4/3.png" alt="GDB Server连接成功"></li>
<li>输入<code>monitor reset</code>来复位MCU，从而让MCU处于确定的状态</li>
<li>输入<code>load</code>往MCU中加载调试文件，也就是常见的烧录过程</li>
<li>输入<code>break main</code>设置main断点，让MCU执行到main中停止</li>
</ol>
<p>下面是使用Power shell的交互过程</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">PS C:\&gt; arm-none-eabi-gdb</span><br><span class="line">GNU gdb (GNU Tools <span class="keyword">for</span> ARM Embedded Processors) <span class="number">7.8</span>.<span class="number">0.20150604</span>-cvs</span><br><span class="line">Copyright (C) <span class="number">2014</span> Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version <span class="number">3</span> or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type <span class="string">"show copying"</span></span><br><span class="line">and <span class="string">"show warranty"</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured as <span class="string">"--host=i686-w64-mingw32 --target=arm-none-eabi"</span>.</span><br><span class="line">Type <span class="string">"show configuration"</span> <span class="keyword">for</span> configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">"help"</span>.</span><br><span class="line">Type <span class="string">"apropos word"</span> to search <span class="keyword">for</span> commands related to <span class="string">"word"</span>.</span><br><span class="line">(gdb) file Demo.elf</span><br><span class="line">Reading symbols from Demo.elf...done.</span><br><span class="line">(gdb) target remote localhost:<span class="number">2331</span></span><br><span class="line">Remote debugging using localhost:<span class="number">2331</span></span><br><span class="line"><span class="number">0</span>x00000000 <span class="keyword">in</span> ?? ()</span><br><span class="line">(gdb) monitor reset</span><br><span class="line">Resetting target</span><br><span class="line">(gdb) load</span><br><span class="line">Loading section .text, size <span class="number">0</span>x434 lma <span class="number">0</span>x8000000</span><br><span class="line">Loading section .data, size <span class="number">0</span>x14 lma <span class="number">0</span>x8000434</span><br><span class="line">Start address <span class="number">0</span>x80003ec, load size <span class="number">1096</span></span><br><span class="line">Transfer rate: <span class="number">59</span> KB/sec, <span class="number">548</span> bytes/write.</span><br><span class="line">(gdb) <span class="built_in">break</span> main</span><br><span class="line">Breakpoint <span class="number">1</span> at <span class="number">0</span>x8000112: file src\App\main.c, line <span class="number">27</span>.</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint <span class="number">1</span>, main () at src\App\main.c:<span class="number">27</span></span><br><span class="line"><span class="number">27</span>              int i = <span class="number">0</span>;</span><br><span class="line">(gdb) l</span><br><span class="line"><span class="number">22</span>      /* Includes ------------------------------------------------------------------*/</span><br><span class="line"><span class="number">23</span>      <span class="comment">#include "stm32f10x.h"</span></span><br><span class="line"><span class="number">24</span>      <span class="comment">#include &lt;stdio.h&gt;</span></span><br><span class="line"><span class="number">25</span>      int main(void)</span><br><span class="line"><span class="number">26</span>      &#123;</span><br><span class="line"><span class="number">27</span>              int i = <span class="number">0</span>;</span><br><span class="line"><span class="number">28</span></span><br><span class="line"><span class="number">29</span></span><br><span class="line"><span class="number">30</span>              <span class="keyword">for</span>(int m = <span class="number">0</span>; m &lt; <span class="number">100</span>; m++)</span><br><span class="line"><span class="number">31</span>              &#123;</span><br><span class="line">(gdb) l</span><br><span class="line"><span class="number">32</span>                      i = m + i;</span><br><span class="line"><span class="number">33</span>              &#125;</span><br><span class="line"><span class="number">34</span></span><br><span class="line"><span class="number">35</span>              <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">36</span>      &#125;</span><br><span class="line">(gdb) s</span><br><span class="line"><span class="number">30</span>              <span class="keyword">for</span>(int m = <span class="number">0</span>; m &lt; <span class="number">100</span>; m++)</span><br><span class="line">(gdb) s</span><br><span class="line"><span class="number">32</span>                      i = m + i;</span><br><span class="line">(gdb) s</span><br><span class="line"><span class="number">30</span>              <span class="keyword">for</span>(int m = <span class="number">0</span>; m &lt; <span class="number">100</span>; m++)</span><br><span class="line">(gdb) s</span><br><span class="line"><span class="number">32</span>                      i = m + i;</span><br><span class="line">(gdb) p m</span><br><span class="line"><span class="variable">$1</span> = <span class="number">1</span></span><br><span class="line">(gdb) <span class="built_in">break</span> <span class="number">35</span></span><br><span class="line">Breakpoint <span class="number">2</span> at <span class="number">0</span>x8000130: file src\App\main.c, line <span class="number">35</span>.</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Breakpoint <span class="number">2</span>, main () at src\App\main.c:<span class="number">35</span></span><br><span class="line"><span class="number">35</span>              <span class="built_in">return</span> <span class="number">0</span>;</span><br><span class="line">(gdb) p i</span><br><span class="line"><span class="variable">$2</span> = <span class="number">4950</span></span><br><span class="line">(gdb) q</span><br><span class="line">A debugging session is active.</span><br><span class="line"></span><br><span class="line">        Inferior <span class="number">1</span> [Remote target] will be killed.</span><br><span class="line"></span><br><span class="line">Quit anyway? (y or n) y</span><br></pre></td></tr></table></figure>
<h3 id="参考资料：">参考资料：</h3><ol>
<li>gcc manual</li>
<li>gdb manual</li>
<li>jlink user manual, charapter 3.3 J-link GDB Server</li>
<li>scons user guide</li>
<li>scons manual</li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Jlink/">Jlink</a><a class="article-category-link" href="/categories/Jlink/gcc/">gcc</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Create-your-IAR-project-template" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/02/Create-your-IAR-project-template/" class="article-date">
  	<time datetime="2015-10-02T05:29:55.000Z" itemprop="datePublished">2015-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/02/Create-your-IAR-project-template/">创建IAR模版工程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="前言">前言</h3><p>如果你用过IAR，用过STM32，那一定会知道创建新STM32工程时有多痛苦，创建空工程，添加group，添加代码，添加宏定义，选择STM32芯片等步骤<br>每次新建工程，都需要重新来一遍，那有没有更简单的步骤呢？答案是yes！</p>
<p>假设我们需要在IAR中添加一个STM32F4的工程模版，那么所需要的东西如下：</p>
<ol>
<li>IAR 7.20 For ARM</li>
<li>Win7</li>
<li>STM32F4xx 标准库文件</li>
</ol>
<p>基本步骤包括</p>
<ol>
<li>创建IAR标准模版工程</li>
<li>把模版放到IAR安装目录（patch）</li>
<li>修改配置文件</li>
</ol>
<p>很简单，让我们一步一步来实现这个功能</p>
<h3 id="1_创建IAR标准工程">1 创建IAR标准工程</h3><p>像平时一样，根据自己的工程管理习惯，用IAR创建一个工程，然后调整代码和相关工程配置项，调试编译通过</p>
<p><strong>特别注意：创建工程时，需要保证IAR工程文件在最顶层目录</strong><br><img src="http://cedar-renjun.github.io/images/2015/10/3/1.png" alt="工程目录组织结构"></p>
<p>创建好的目录如下所示</p>
<p><img src="http://cedar-renjun.github.io/images/2015/10/3/0.png" alt="创建好的IAR工程"></p>
<h3 id="2_添加模版工程">2 添加模版工程</h3><p>接下来，我们需要将标准工程修改为模版工程</p>
<ol>
<li>删除<code>Debug</code>和<code>settings</code>目录，某些情况下，还有存在<code>Release</code>目录，请删除</li>
<li>删除<code>*.dep</code>, <code>*.ewt</code>, <code>*.ewd</code>,<code>*.eww</code>四种IAR工程文件，只保留<code>*.ewp</code>文件<br>关于上面5种文件的详细分析，请参考本博客上篇文章<a href="http://cedar-renjun.github.io/2015/10/02/IAR-projects-template/">IAR工程文件分析</a></li>
<li>修改<code>*.ewp</code>文件名为<code>templproj.ewp</code></li>
</ol>
<p>至此，修改完成，如下图所示<br><img src="http://cedar-renjun.github.io/images/2015/10/3/3.png" alt="修改好的IAR工程"></p>
<h3 id="3_修改配置文件">3 修改配置文件</h3><p>接下来，我们将这个模块添加到IAR工程中</p>
<ol>
<li>在桌面新建一个临时文件夹，名为<code>tmp</code></li>
<li>在<code>tmp</code>中新建目录<code>STM32</code>,</li>
<li>在<code>STM32</code>中新建目录<code>F4xx</code></li>
<li><p>将我们创建的模版工程拷入<code>F4xx</code>目录，如下所示</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">│ </span><br><span class="line">└─STM32</span><br><span class="line">    │ </span><br><span class="line">    └─F4xx</span><br><span class="line">        │ templproj.ewp</span><br><span class="line">        ├─App</span><br><span class="line">        └─Libs</span><br></pre></td></tr></table></figure>
</li>
<li><p>进入<code>C:\Program Files\IAR Systems\Embedded Workbench 7.2\arm\config\template\project</code>目录，拷贝<code>C.ENU.projtempl</code>文件到<code>STM32</code>和<code>F4xx</code>同级目录，然后修改名字为<code>STM32.ENU.projtempl</code>,<code>F4xx.ENU.projtempl</code>，修改完成后，结构如下所示</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">│ STM32.ENU.projtempl</span><br><span class="line">└─STM32</span><br><span class="line">    │ F4xx.ENU.projtempl</span><br><span class="line">    └─F4xx</span><br><span class="line">        │ templproj.ewp</span><br><span class="line">        ├─App</span><br><span class="line">        └─Libs</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><strong>特别注意：<code>projtempl</code>的名字一定要和目录名字完全一致，不然IAR找不到对应的文件夹</strong><br><code>*.projtempl</code>文件用于展示工程模版的基本信息，比如名字和简介什么的<br>下面我们分别将两个文件修改为下面样式<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--STM32.ENU.projtempl file--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">templategroup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">description</span>&gt;</span>STM32 Project template for f0/1/2/4/7 mcu<span class="tag">&lt;/<span class="title">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">displayname</span>&gt;</span>STM32<span class="tag">&lt;/<span class="title">displayname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">templategroup</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="pi">&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;</span></span><br><span class="line"><span class="comment">&lt;!--F4xx.ENU.projtempl file--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">templategroup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">description</span>&gt;</span>STM32 Project template for f4xx mcu<span class="tag">&lt;/<span class="title">description</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">displayname</span>&gt;</span>F4xx<span class="tag">&lt;/<span class="title">displayname</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">templategroup</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="测试">测试</h3><p>上面几个步骤，看起来很复杂，但实际操作起来，也挺简单的</p>
<p>下面我们来测试效果，将上面<code>tmp</code>文件中所有文件，拷贝至<code>C:\Program Files\IAR Systems\Embedded Workbench 7.2\arm\config\template\project</code>目录</p>
<p>在IAR中，新建工程，这时便会出现STM32模版工程，如下图所示<br><img src="http://cedar-renjun.github.io/images/2015/10/3/6.png" alt="选择工程模版"></p>
<p>选择STM32，然后选择F4，新建工程，完成后如下图所示，finish<br><img src="http://cedar-renjun.github.io/images/2015/10/3/7.png" alt="新建的IAR工程"></p>
<h3 id="后记">后记</h3><p>在IAR 7.2上测试时，时常出现不可复现的bug，也许和破解有关系，具体表现为<br>在显示层次模版目录时，无法显示子目录；UI层次上就是新建IAR工程时，能显示STM32模版，但不能显示F4xx模版信息</p>
<p>暂时无解</p>
<p>规避方案：直接复制IAR模版文件，然后适当修改即可，千万不要重写<code>templproj</code>!!!</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/IAR/">IAR</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-IAR-projects-template" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/02/IAR-projects-template/" class="article-date">
  	<time datetime="2015-10-02T02:35:55.000Z" itemprop="datePublished">2015-10-02</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/02/IAR-projects-template/">IAR 工程文件分析</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>注意：下文以IAR 7.2 For ARM版本来分析XML工程文件</p>
<h3 id="初衷">初衷</h3><p>IAR工程中添加文件，一直很麻烦，最近发现RTT用Scons能自动生成IAR模版，并添加源文件，为此分析了IAR工程管理结构，重点在于源文件管理结构</p>
<h3 id="构建语法">构建语法</h3><p>采用标准XML形式来构建工程</p>
<p>在新建工程后，IAR默认包含debug和release两个模版，在XML文件中，有所体现，我们可以在XML中删掉release的配置信息，减轻我们分析的负担</p>
<h3 id="IAR_工程结构">IAR 工程结构</h3><ul>
<li>*.ewp IAR工程文件，包含配置项和文件列表</li>
<li>*.ewt IAR配置文件，包含C-STAT和RuntimeChecking的信息</li>
<li>*.dep IAR调试信息配置，主要用于描述源文件和obj文件的关联信息</li>
<li>*.eww IAR workspace，用于管理多个project</li>
<li>*.ewd 调试相关，比如选择的调试器和调试器ID等等</li>
</ul>
<p>简单介绍一下用途<br>1）如果只是保留基本工程信息，不需要调试器和链接器的信息，只保留<code>eww</code>和<code>ewp</code>文件即可<br>2）如果需要保存链接器和调试器信息，保留<code>ewp</code>, <code>ewt</code>, <code>dep</code>, <code>eww</code>四个文件即可<br>3）<code>ewt</code>主要包含一些静态检查和动态检查，可以不用这些配置项</p>
<p>也就是说，在复制IAR工程时，只需要保留这几个文件，其它的文件（夹）都可以删掉，比如setting, Debug，Release文件夹</p>
<p>因为分析IAR主要是为了自动生成模版文件，所以下面重点分析<code>ewp</code>文件结构</p>
<h3 id="ewp文件分析">ewp文件分析</h3><p>打开文件，可以看到顶层结构为<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">project</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">fileVersion</span>&gt;</span>2<span class="tag">&lt;/<span class="title">fileVersion</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span>Debug工程配置<span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">configuration</span>&gt;</span>Release工程配置<span class="tag">&lt;/<span class="title">configuration</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">file</span>&gt;</span>工程文件结构<span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">project</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>这里加注了行号，第3/4行为工程具体配置，包括<code>Debug</code>和<code>Release</code>版本配置，还可以添加其它配置页，为了简化分析，我删掉了<code>Release</code>配置项，再次打开IAR工程，如下所示：</p>
<p>第5行是工程文件目录结构，也是我们重点分析的部分，主要分为两块</p>
<ol>
<li>单个文件</li>
<li>目录组织结构</li>
</ol>
<p>我在创建IAR工程时，只包含一个main.c文件，XML对应结构如下<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\main.c<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>尝试添加两个源文件<code>test.c</code> <code>test.h</code>, XML 结构变成下面的形式<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\main.c<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\test.c<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\test.h<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>可见每一个文件对应一个file结构，我们尝试新建一个group，然后将test.c和test.h文件放到里面</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">group</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>test<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\test.c<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\test.h<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">group</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">file</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">name</span>&gt;</span>$PROJ_DIR$\main.c<span class="tag">&lt;/<span class="title">name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">file</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可见增加了一个<code>group</code>结构，并用<code>name</code>来表示group的名字<br>OK，分析到这里，我们就可以利用python来编写脚本自动添加文件到IAR工程中了</p>
<p>至于<code>Debug</code>配置项的细节信息，等有机会慢慢研究</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/IAR/">IAR</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-Introduce-Raspberry-2B" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/10/01/Introduce-Raspberry-2B/" class="article-date">
  	<time datetime="2015-10-01T13:25:40.000Z" itemprop="datePublished">2015-10-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/10/01/Introduce-Raspberry-2B/">“树莓派2B＋学习笔记-开篇”</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="前言">前言</h2><p>github这个博客好久更新了，大概有一年吧，期间各种事情，其实主要原因还是自己懒<br>终究发现做技术的，还是要常常做一些笔记，不然就会容易忘记，所以今天重抄旧业，将hexo升级到了3.1.0</p>
<p>接下来会不断更新蓝牙4.0和linux，USB相关知识</p>
<p>先拿树莓派开刀吧^_^</p>
<h2 id="1_致谢">1 致谢</h2><p>最近一直想学linux驱动编程和学习内核，刚好得到一块儿树莓派2B，所以准备用心搞一下<br>在此特意感谢21ic 小跑堂美女和may美女</p>
<p><img src="http://cedar-renjun.github.io/images/2015/10/1/Pi_2_Model_B.png" alt="树莓派图片"></p>
<h2 id="2_树莓派2B升级了什么">2 树莓派2B升级了什么</h2><p>下面是官方网站展示的2B的性能参数：</p>
<ul>
<li>A 900MHz quad-core ARM Cortex-A7 CPU</li>
<li>1GB RAM</li>
<li>4 USB ports</li>
<li>40 GPIO pins</li>
<li>Full HDMI port</li>
<li>Ethernet port</li>
<li>Combined 3.5mm audio jack and composite video</li>
<li>Camera interface (CSI)</li>
<li>Display interface (DSI)</li>
<li>Micro SD card slot</li>
<li>VideoCore IV 3D graphics core</li>
</ul>
<p>相比于前代的树莓派，2B采用TF卡，尺寸更小，也去掉了不常用的RCA接口（俗称AV接口），完全采用HDMI接口<br>这么改，最大的好处就是树莓派形状变得很整齐，不再像原来那样突起一部分</p>
<p>从处理器来说，将原来的高通BCM2835更新到了BCM2836，增大RAM到1G，估计你对这些也不太感冒，只要知道速度提高了6倍就好了</p>
<p>因为处理器架构从ARM7TMDI变成了4核A7，所以能跑标准的操作系统，比如安卓或者ubuntu或者win10</p>
<p>大致看了win10烧录内核的步骤，看到“首先你需要一台运行win10的笔记本”，看到这里就没继续看了，哪位有兴趣的可以自己根据官方博客来实战游戏</p>
<p><a href="https://www.raspberrypi.org/blog/windows-10-for-iot/" target="_blank" rel="external">https://www.raspberrypi.org/blog/windows-10-for-iot/</a> <br><br><a href="https://dev.windows.com/zh-cn/iot" target="_blank" rel="external">https://dev.windows.com/zh-cn/iot</a> <br></p>
<p>对了，树莓派2B支持DSI显示接口和CSI相机接口，从而可以直接高速视频输入和屏幕输出<br>这个有什么用呢？理论上来说，你可以拿树莓派做一个平板电脑</p>
<p>树莓派的简单介绍到这里，接下来介绍烧录系统，更新内核，跑opencv做人脸识别</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/树莓派/">树莓派</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-coding-standard" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/11/16/coding-standard/" class="article-date">
  	<time datetime="2014-11-16T08:47:24.000Z" itemprop="datePublished">2014-11-16</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/11/16/coding-standard/">C语言编码规范</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="0_头文件注释">0 头文件注释</h2><p><strong>原则</strong><br>用于说明本文件的用途，作者，协议等信息</p>
<p><strong>示例</strong></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//******************************************************************************************</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! \file   FIFO.h</span></span><br><span class="line"><span class="comment">//! \brief  Genernal FIFO Model Interface.</span></span><br><span class="line"><span class="comment">//!         You can use uniform FIFO Model to manager Any type of data element.</span></span><br><span class="line"><span class="comment">//! \author cedar</span></span><br><span class="line"><span class="comment">//! \date   2013-12-16</span></span><br><span class="line"><span class="comment">//! \email  xuesong5825718@gmail.com</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! \license</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! Copyright (c) 2013 Cedar MIT License</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! Permission is hereby granted, free of charge, to any person obtaining a copy</span></span><br><span class="line"><span class="comment">//! of this software and associated documentation files (the "Software"), to deal</span></span><br><span class="line"><span class="comment">//! in the Software without restriction, including without limitation the rights to</span></span><br><span class="line"><span class="comment">//! use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of</span></span><br><span class="line"><span class="comment">//! the Software, and to permit persons to whom the Software is furnished to do so,</span></span><br><span class="line"><span class="comment">//! subject to the following conditions:</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! The above copyright notice and this permission notice shall be included in all</span></span><br><span class="line"><span class="comment">//! copies or substantial portions of the Software.</span></span><br><span class="line"><span class="comment">//!</span></span><br><span class="line"><span class="comment">//! THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span></span><br><span class="line"><span class="comment">//! IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span></span><br><span class="line"><span class="comment">//! FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span></span><br><span class="line"><span class="comment">//! AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span></span><br><span class="line"><span class="comment">//! LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span></span><br><span class="line"><span class="comment">//! OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span></span><br><span class="line"><span class="comment">//! IN THE SOFTWARE.</span></span><br><span class="line"><span class="comment">///</span></span><br><span class="line"><span class="comment">//******************************************************************************************</span></span><br></pre></td></tr></table></figure>
<h2 id="1_头文件防冲突宏">1 头文件防冲突宏</h2><p><strong>原则</strong><br>用于防止头文件被多次包含，从而导致编译，链接错误</p>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/教程/">教程</a>
	</div>


      
        <p class="article-more-link">
          <a  href="/2014/11/16/coding-standard/#more">more >></a>
        </p>
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-iar-warming-25-problem" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/28/iar-warming-25-problem/" class="article-date">
  	<time datetime="2014-10-28T12:30:05.000Z" itemprop="datePublished">2014-10-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/28/iar-warming-25-problem/">IAR Warming 25 Problem</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="出现问题">出现问题</h2><p>IAR版本之间不兼容是臭名昭著的问题，在IAR7.0版本完全正常的代码，放到IAR7.10版本中编译，会出现下面的警告</p>
<pre><code>Warning[<span class="number">25</span>]: Label <span class="string">'MemManage_Handler'</span> is defined pubweak <span class="keyword">in</span> <span class="tag">a</span> <span class="tag">section</span> implicitly declared root
</code></pre><h2 id="解决方案">解决方案</h2><p>在对应的SECTION声明中，添加<code>NOROOT</code>修饰信息，如下所示</p>
<p>由</p>
<pre><code>        PUBWEAK MemManage_Handler
        SECTION <span class="class">.text</span>:CODE:<span class="function"><span class="title">REORDER</span><span class="params">(<span class="number">1</span>)</span></span>
MemManage_Handler
        B MemManage_Handler
</code></pre><p>改为</p>
<pre><code>        PUBWEAK MemManage_Handler
        SECTION <span class="class">.text</span>:CODE:REORDER:<span class="function"><span class="title">NOROOT</span><span class="params">(<span class="number">1</span>)</span></span>
MemManage_Handler
        B MemManage_Handler
</code></pre>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/IAR/">IAR</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
    <article id="post-qt-chinese-decoder" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2014/10/25/qt-chinese-decoder/" class="article-date">
  	<time datetime="2014-10-25T15:25:19.000Z" itemprop="datePublished">2014-10-25</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2014/10/25/qt-chinese-decoder/">QT5 VS2013 中文乱码问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="问题">问题</h2><p>QT4中的中文乱码问题，可以通过在实例前增加下面代码来解决</p>
<pre><code><span class="rule"><span class="attribute">QTextCodec</span>:<span class="value">:<span class="function">setCodecForTr</span>(QTextCodec::<span class="function">codecForLocale</span>())</span></span>;
</code></pre><p>但QT5中，取消了这个函数，又该如何解决呢</p>
<h2 id="解决方案">解决方案</h2><p>经测试，只要是源代码文件采用UTF8编码（不带签名）保存，不需要添加任何代码，就可以显示中文</p>
<p>VS2013需要设置如下</p>
<pre><code>FILE-&gt;Advanced Save <span class="built_in">Option</span>-&gt;Encoding-&gt; UTF8 without signature - Codepage <span class="number">65001</span>
</code></pre><p><img src="!--￼0--&gt;/images/2014/10/25/vs2013_utf8.png" alt=""></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/QT/">QT</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>







  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 Do one thing and do it well
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>